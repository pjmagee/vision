@page "/assets"
@inject HttpClient HttpClient
@using Newtonsoft.Json;

<BreadcrumbsComponent>
    <li class="breadcrumb-item active">Assets</li>
</BreadcrumbsComponent>

@if (Items != null)
{
    foreach (var item in Items)
    {
        if (item.Items != null)
        {
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">@item.Title</h6>
                </div>
                <div class="card-body">
                    <AssetsComponent Items="item.Items"></AssetsComponent>
                </div>
            </div>
        }
    }
}
else
{
    <LoaderComponent></LoaderComponent>
}

@functions
{
    private AssetMetricDto[] Items { get; set; }

    protected override async Task OnInitAsync()
    {
        string json = await HttpClient.GetStringAsync("/api/assets/metrics");
        Items = JsonConvert.DeserializeObject<AssetMetricDto[]>(json);
    }
}
